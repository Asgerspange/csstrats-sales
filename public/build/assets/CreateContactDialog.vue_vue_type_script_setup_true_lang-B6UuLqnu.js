import{_ as V}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-OpzGvXRM.js";import{_ as $,a as x,b as w,c as k,d as N,e as j,f as U}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-CuTzJjOB.js";import{_ as r}from"./Input.vue_vue_type_script_setup_true_lang-QC2PCJp3.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-NIhfrirA.js";import{_ as E,a as S,b as T,c as h,d as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-BRD2wz09.js";import{d as O,r as v,h as m,o as u,w as l,b as s,f as a,i as n,e as i,a as B,F as A,g as D,l as J,m as L,t as P}from"./app-DEnSzFvd.js";import{u as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-CoB_MmX7.js";import{L as q}from"./loader-circle-Ci5d0E_I.js";const R={class:"grid gap-4 py-4"},X={class:"grid grid-cols-4 items-center gap-4"},z={class:"grid grid-cols-4 items-center gap-4"},G={class:"grid grid-cols-4 items-center gap-4"},H={class:"grid grid-cols-4 items-center gap-4"},I={class:"grid grid-cols-4 items-center gap-4"},M={class:"grid grid-cols-4 items-center gap-4"},le=O({__name:"CreateContactDialog",props:["organisation"],setup(f){const y=f,{toast:c}=K(),o=v({name:"",email:"",phone:"",country:"",job:"",organisation_id:y.organisation?.id??""}),p=v(!1),_=v(!1),b=async()=>{p.value=!0;let g={...o.value,country:o.value.country.toUpperCase()};try{const e=await fetch("/contacts",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify(g)});if(e.status===201){const t=await e.json();c({title:"Contact Created",description:`${t.contact.name} has been created successfully.`,variant:"success"}),o.value={name:"",email:"",phone:"",country:"",job:"",organisation_id:""},_.value=!1;const C=["contacts"];y.organisation&&C.push("organisation"),L.reload({only:C})}else if(e.status===409)c({title:"Email Already Exists",description:`${o.value.name} could not be created because the email already exists.`,variant:"destructive"});else{const t=await e.json();c({title:"Contact Creation Failed",description:t?.message||"Contact could not be created.",variant:"destructive"})}}catch{c({title:"Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{p.value=!1}};return(g,e)=>(u(),m(a(U),{open:_.value,"onUpdate:open":e[7]||(e[7]=t=>_.value=t)},{default:l(()=>[s(a($),{"as-child":""},{default:l(()=>[s(a(V),{variant:"success"},{default:l(()=>e[8]||(e[8]=[n("New Contact",-1)])),_:1,__:[8]})]),_:1}),s(a(x),{class:"sm:max-w-[425px]"},{default:l(()=>[s(a(w),null,{default:l(()=>[s(a(k),null,{default:l(()=>e[9]||(e[9]=[n("New Contact",-1)])),_:1,__:[9]}),s(a(N),null,{default:l(()=>e[10]||(e[10]=[n(" Fill in the contact details below and click save. ",-1)])),_:1,__:[10]})]),_:1}),i("div",R,[i("div",X,[s(a(d),{for:"name",class:"text-right"},{default:l(()=>e[11]||(e[11]=[n("Name",-1)])),_:1,__:[11]}),s(a(r),{id:"name",placeholder:"Contact Name",class:"col-span-3",modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.name=t)},null,8,["modelValue"])]),i("div",z,[s(a(d),{for:"email",class:"text-right"},{default:l(()=>e[12]||(e[12]=[n("Email",-1)])),_:1,__:[12]}),s(a(r),{id:"email",placeholder:"Email",class:"col-span-3",modelValue:o.value.email,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.email=t)},null,8,["modelValue"])]),i("div",G,[s(a(d),{for:"phone",class:"text-right"},{default:l(()=>e[13]||(e[13]=[n("Phone",-1)])),_:1,__:[13]}),s(a(r),{id:"phone",placeholder:"Phone",class:"col-span-3",modelValue:o.value.phone,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.phone=t)},null,8,["modelValue"])]),i("div",H,[s(a(d),{for:"country",class:"text-right"},{default:l(()=>e[14]||(e[14]=[n("Country",-1)])),_:1,__:[14]}),s(a(r),{id:"country",placeholder:"DK",maxlength:"2",class:"col-span-3 uppercase",modelValue:o.value.country,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.country=t)},null,8,["modelValue"])]),i("div",I,[s(a(d),{for:"job",class:"text-right"},{default:l(()=>e[15]||(e[15]=[n("Job",-1)])),_:1,__:[15]}),s(a(r),{id:"job",placeholder:"Job Title",class:"col-span-3",modelValue:o.value.job,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.job=t)},null,8,["modelValue"])]),i("div",M,[s(a(d),{class:"text-right"},{default:l(()=>e[16]||(e[16]=[n("Organisation",-1)])),_:1,__:[16]}),f.organisation?(u(),m(a(r),{key:0,modelValue:f.organisation.name,readonly:"",class:"w-fit"},null,8,["modelValue"])):(u(),m(a(E),{key:1,modelValue:o.value.organisation_id,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.organisation_id=t),class:"w-100"},{default:l(()=>[s(a(S),{class:"col-span-3"},{default:l(()=>[s(a(T),{placeholder:"Select organisation"})]),_:1}),s(a(h),null,{default:l(()=>[(u(!0),B(A,null,D(g.$page.props.organisations,t=>(u(),m(a(F),{key:t.id,value:t.id},{default:l(()=>[n(P(t.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]))])]),s(a(j),null,{default:l(()=>[s(a(V),{type:"submit",onClick:e[6]||(e[6]=t=>b()),disabled:p.value,variant:"success"},{default:l(()=>[p.value?(u(),m(a(q),{key:0,class:"h-4 w-4 animate-spin"})):J("",!0),e[17]||(e[17]=n(" Create Contact ",-1))]),_:1,__:[17]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]))}});export{le as _};
