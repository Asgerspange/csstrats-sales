import{a as N,b as U,c as F,_ as A}from"./AppLayout.vue_vue_type_script_setup_true_lang-DANxfHyB.js";import{d as k,i as _,e as u,h as n,f as o,g as e,u as D,r as $,c as R,x as w,F as x,w as d,j as C,b as v,m as M,t as T,p as L,s as I}from"./app-BacqOfn3.js";import{_ as j}from"./Input.vue_vue_type_script_setup_true_lang-CbEJygc0.js";import{_ as S}from"./Checkbox.vue_vue_type_script_setup_true_lang-Cmq_lgaL.js";import{_ as B,a as E,b as K,c as V,d as P,e as z}from"./TableHeader.vue_vue_type_script_setup_true_lang-DcFmgeeI.js";import{_ as H,v as q}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C8n_WpZs.js";import{u as G,F as O,g as J,a as Q,b as W}from"./index-BvCXLVbM.js";import{A as X}from"./arrow-up-down-BOZ6czmF.js";import{_ as Y}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-C1Ocof-Q.js";import"./useForwardExpose-TW6ypeNl.js";import"./VisuallyHidden-5Gc-k0FP.js";import"./useFormControl-CUXCosYr.js";import"./VisuallyHiddenInput-B8fqAXzY.js";import"./check-CZIyiA-v.js";const Z={class:"flex items-center gap-8"},ee={class:"flex items-center gap-4 w-full"},te={class:"flex items-center gap-2"},se={class:"flex items-center gap-2"},ae=k({__name:"TacticFilters",props:{filters:{},columns:{}},emits:["update:filters","update:columns"],setup(h,{emit:g}){const p=h,f=g,b=a=>{f("update:filters",{...p.filters,searchTerm:a})},c=a=>{f("update:filters",{...p.filters,releasedOnly:a})},m=a=>{f("update:filters",{...p.filters,unreleasedOnly:a})};return(a,s)=>(u(),_("div",Z,[n("div",ee,[o(e(j),{"model-value":a.filters.searchTerm,"onUpdate:modelValue":b,type:"text",placeholder:"Search subscriptions (Customer [Email, Id, Name], Package)",class:"input input-bordered w-full max-w-lg"},null,8,["model-value"]),n("div",te,[o(e(S),{"model-value":a.filters.releasedOnly,"onUpdate:modelValue":c,class:"ml-4"},null,8,["model-value"]),s[0]||(s[0]=n("label",null,"Released only",-1))]),n("div",se,[o(e(S),{"model-value":a.filters.unreleasedOnly,"onUpdate:modelValue":m,class:"ml-4"},null,8,["model-value"]),s[1]||(s[1]=n("label",null,"Unreleased only",-1))])])]))}}),le={class:"flex items-center justify-between space-x-2 py-4"},re={class:"flex items-center space-x-2"},ne={class:"text-sm text-gray-700"},oe={class:"flex space-x-1"},ie=["disabled"],de=["disabled"],ue=["disabled"],ce=["disabled"],me=k({__name:"TacticTable",props:{columns:{},filters:{}},setup(h){const{unreleasedTactics:g,releasedTactics:p}=D().props,f=$([...g,...p]),b=$([]),c=h,m=R(()=>c.columns.filter(t=>!["player_descriptions","player_timestamps","player_loadouts","matchdate","team"].includes(t.column)).map(t=>{const l=["id","created_at","status","product_id"].includes(t.column);return{accessorKey:t.column,header:({column:r})=>(t.header==="Created_at"&&(t.header="Created At"),t.header==="Release_date"&&(t.header="Release Date"),t.header==="Is_released"&&(t.header="Status"),t.header==="Team_name"&&(t.header="Team"),l?w(H,{variant:"ghost",onClick:()=>r.toggleSorting(r.getIsSorted()==="asc")},()=>[t.header,w(X,{class:"ml-2 h-4 w-4"})]):w("span",t.header)),accessorFn:r=>r[t.column],cell:({getValue:r,row:i})=>{const y=r();return t.column==="is_released"?y?"Released":"Not Released":t.column==="created_at"?new Date(i.original.created_at).toLocaleDateString():t.column==="release_date"?new Date(i.original.release_date).toLocaleDateString():t.column==="matchlink"?w("a",{href:y,target:"_blank",class:"text-blue-600 underline"},"View Match"):t.column==="tags"&&Array.isArray(y)?y.join(", "):y},enableSorting:l}})),a=R(()=>{let t=f.value||[];if(console.log("Filtering tactics with",t),c.filters.searchTerm){const l=c.filters.searchTerm.toLowerCase();t=t.filter(r=>r.team_name.toLowerCase().includes(l)||r.description.toLowerCase().includes(l)||r.tags.some(i=>i.toLowerCase().includes(l)))}return c.filters.releasedOnly&&(t=t.filter(l=>l.is_released===!0)),c.filters.unreleasedOnly&&(t=t.filter(l=>l.is_released===!1)),t||[]}),s=G({get data(){return a.value},get columns(){return m.value},getCoreRowModel:W(),getPaginationRowModel:Q(),getSortedRowModel:J(),onSortingChange:t=>q(t,b),state:{get sorting(){return b.value}},initialState:{pagination:{pageSize:10},sorting:[]}});return(t,l)=>(u(),_(x,null,[o(e(B),null,{default:d(()=>[o(e(E),null,{default:d(()=>[(u(!0),_(x,null,C(e(s).getHeaderGroups(),r=>(u(),v(e(P),{key:r.id},{default:d(()=>[(u(!0),_(x,null,C(r.headers,i=>(u(),v(e(z),{key:i.id},{default:d(()=>[i.isPlaceholder?L("",!0):(u(),v(e(O),{key:0,render:i.column.columnDef.header,props:{column:i.column}},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),o(e(K),null,{default:d(()=>[e(s).getRowModel().rows.length?(u(!0),_(x,{key:0},C(e(s).getRowModel().rows,r=>(u(),v(e(P),{key:r.id,class:"cursor-pointer hover:bg-gray-100"},{default:d(()=>[(u(!0),_(x,null,C(r.getVisibleCells(),i=>(u(),v(e(V),{key:i.id},{default:d(()=>[o(e(O),{render:i.column.columnDef.cell||(()=>i.getValue()),props:{getValue:()=>i.getValue(),row:r}},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(u(),v(e(P),{key:1},{default:d(()=>[o(e(V),{colspan:m.value.length,class:"h-24 text-center"},{default:d(()=>l[4]||(l[4]=[M(" No tactics found. ",-1)])),_:1,__:[4]},8,["colspan"])]),_:1}))]),_:1})]),_:1}),n("div",le,[n("div",re,[n("span",ne," Page "+T(e(s).getState().pagination.pageIndex+1)+" of "+T(e(s).getPageCount())+" ("+T(e(s).getFilteredRowModel().rows.length)+" total rows) ",1),n("div",oe,[n("button",{onClick:l[0]||(l[0]=r=>e(s).setPageIndex(0)),disabled:!e(s).getCanPreviousPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," First ",8,ie),n("button",{onClick:l[1]||(l[1]=r=>e(s).previousPage()),disabled:!e(s).getCanPreviousPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Previous ",8,de),n("button",{onClick:l[2]||(l[2]=r=>e(s).nextPage()),disabled:!e(s).getCanNextPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Next ",8,ue),n("button",{onClick:l[3]||(l[3]=r=>e(s).setPageIndex(e(s).getPageCount()-1)),disabled:!e(s).getCanNextPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Last ",8,ce)])])])],64))}}),fe={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto"},pe={class:"flex items-center justify-between"},Se=k({__name:"Release",setup(h){const{props:g}=D();console.log(g.releasedTactics[0]);const p=[{title:"Admin",href:"/admin"},{title:"Tactics",href:"/admin/tactics"},{title:"Release",href:"/admin/tactics/release"}],f=$({searchTerm:"",activeOnly:!1,pastDueOnly:!1}),b=["count","video","deleted_by"],c=$(Object.keys(g.releasedTactics[0]||{}).filter(m=>!b.includes(m)).map(m=>({column:m,header:m.charAt(0).toUpperCase()+m.slice(1),active:!0,direction:"asc"})));return(m,a)=>(u(),_(x,null,[o(e(I),{title:"Tactics"}),o(A,{breadcrumbs:p},{default:d(()=>[n("div",fe,[n("div",pe,[a[4]||(a[4]=n("h1",{class:"text-2xl font-bold"},"Tactics",-1)),o(e(N),null,{default:d(()=>[o(e(U),{"as-child":""},{default:d(()=>a[2]||(a[2]=[n("button",{class:"btn btn-primary"},"Actions",-1)])),_:1,__:[2]}),o(e(F),null,{default:d(()=>[o(e(Y),{checked:""},{default:d(()=>a[3]||(a[3]=[M("Export CSV",-1)])),_:1,__:[3]})]),_:1})]),_:1})]),o(e(ae),{filters:f.value,"onUpdate:filters":a[0]||(a[0]=s=>f.value=s),columns:c.value,"onUpdate:columns":a[1]||(a[1]=s=>c.value=s)},null,8,["filters","columns"]),o(e(me),{filters:f.value,columns:c.value},null,8,["filters","columns"])])]),_:1})],64))}});export{Se as default};
