import{_ as P,a as k,b as S,c as M}from"./AppLayout.vue_vue_type_script_setup_true_lang-Dm-R0bL8.js";import{_ as L,a as z,b as D,c as N,d as h,e as F}from"./TableHeader.vue_vue_type_script_setup_true_lang-DYGgvG1D.js";import{u as O,g as B,a as E}from"./index-DrEu-oDV.js";import{d as V,u as j,c as R,a as f,o as u,F as g,b as o,e as i,f as e,w as r,g as C,h as b,i as _,j as A,t as x,m as H,r as T,n as K}from"./app-BGRNuroF.js";import{_ as Y}from"./Input.vue_vue_type_script_setup_true_lang-MYUkNLnO.js";import{_ as U}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-LURPWeXY.js";import{_ as q}from"./Checkbox.vue_vue_type_script_setup_true_lang-CjS8QhJU.js";import{_ as $}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-B3imMGkI.js";import{C as I}from"./chevron-down-D9u7JIpd.js";import"./useForwardExpose-BF0rGXys.js";import"./VisuallyHidden-CVXYfjO4.js";import"./useFormControl-B_dOHgGi.js";import"./VisuallyHiddenInput-DTSDBhEm.js";import"./check-BKbCtaJA.js";const G={class:"flex items-center justify-between space-x-2 py-4"},J={class:"flex items-center space-x-2"},Q=["value"],W={class:"flex items-center space-x-2"},X={class:"text-sm text-gray-700"},Z={class:"flex space-x-1"},ee=["disabled"],te=["disabled"],se=["disabled"],le=["disabled"],ae=V({__name:"CustomerTable",props:{filters:{},columns:{}},setup(w){const m=w,{props:d}=j(),p=R(()=>{let n=d.customers||[];if(m.filters.searchTerm){const t=m.filters.searchTerm.toLowerCase();n=n.filter(a=>a.name?.toLowerCase().includes(t)||a.email?.toLowerCase().includes(t)||a.cus_id?.toLowerCase().includes(t))}m.filters.subscribedOnly&&(n=n.filter(t=>t.subscribed===!0));const s=m.filters.currencies.filter(t=>t.active).map(t=>t.currency);return s.length>0&&s.length<m.filters.currencies.length&&(n=n.filter(t=>s.includes(t.currency))),n}),y=R(()=>m.columns.filter(n=>n.active).map(n=>({accessorKey:n.column,header:n.header,cell:({row:s})=>{const t=s.getValue(n.column);return n.column==="subscribed"?t?"Yes":"No":t}}))),l=O({get data(){return p.value},get columns(){return y.value},getCoreRowModel:E(),getPaginationRowModel:B(),initialState:{pagination:{pageSize:10}}}),v=n=>{H.visit(route("sales.customers.show",n.id))};return(n,s)=>(u(),f(g,null,[o(e(L),null,{default:r(()=>[o(e(z),null,{default:r(()=>[(u(!0),f(g,null,C(e(l).getHeaderGroups(),t=>(u(),b(e(h),{key:t.id},{default:r(()=>[(u(!0),f(g,null,C(t.headers,a=>(u(),b(e(F),{key:a.id},{default:r(()=>[_(x(a.isPlaceholder?"":a.column.columnDef.header),1)]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),o(e(D),null,{default:r(()=>[e(l).getRowModel().rows.length?(u(!0),f(g,{key:0},C(e(l).getRowModel().rows,t=>(u(),b(e(h),{key:t.id,onClick:a=>v(t.original),class:"cursor-pointer hover:bg-gray-100"},{default:r(()=>[(u(!0),f(g,null,C(t.getVisibleCells(),a=>(u(),b(e(N),{key:a.id},{default:r(()=>[_(x(a.getValue()),1)]),_:2},1024))),128))]),_:2},1032,["onClick"]))),128)):(u(),b(e(h),{key:1},{default:r(()=>[o(e(N),{colspan:y.value.length,class:"h-24 text-center"},{default:r(()=>s[5]||(s[5]=[_(" No customers found. ",-1)])),_:1,__:[5]},8,["colspan"])]),_:1}))]),_:1})]),_:1}),i("div",G,[i("div",J,[s[7]||(s[7]=i("span",{class:"text-sm text-gray-700"},"Rows per page:",-1)),i("select",{value:e(l).getState().pagination.pageSize,onChange:s[0]||(s[0]=t=>e(l).setPageSize(Number(t.target.value))),class:"border rounded px-2 py-1"},s[6]||(s[6]=[A('<option value="5">5</option><option value="10">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option>',5)]),40,Q)]),i("div",W,[i("span",X," Page "+x(e(l).getState().pagination.pageIndex+1)+" of "+x(e(l).getPageCount())+" ("+x(e(l).getFilteredRowModel().rows.length)+" total rows) ",1),i("div",Z,[i("button",{onClick:s[1]||(s[1]=t=>e(l).setPageIndex(0)),disabled:!e(l).getCanPreviousPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," First ",8,ee),i("button",{onClick:s[2]||(s[2]=t=>e(l).previousPage()),disabled:!e(l).getCanPreviousPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Previous ",8,te),i("button",{onClick:s[3]||(s[3]=t=>e(l).nextPage()),disabled:!e(l).getCanNextPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Next ",8,se),i("button",{onClick:s[4]||(s[4]=t=>e(l).setPageIndex(e(l).getPageCount()-1)),disabled:!e(l).getCanNextPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Last ",8,le)])])])],64))}}),oe={class:"flex items-center gap-8"},re={class:"flex items-center gap-4 w-full"},ne={class:"flex items-center gap-2"},ie=V({__name:"CustomerFilters",props:{filters:{},columns:{}},emits:["update:filters","update:columns"],setup(w,{emit:m}){const d=w,p=m,y=s=>{p("update:filters",{...d.filters,searchTerm:s})},l=s=>{p("update:filters",{...d.filters,subscribedOnly:s})},v=(s,t)=>{const a=d.columns.map(c=>c.column===s?{...c,active:t}:c);p("update:columns",a)},n=(s,t)=>{const a=d.filters.currencies.map(c=>c.currency===s?{...c,active:t}:c);p("update:filters",{...d.filters,currencies:a})};return(s,t)=>(u(),f("div",oe,[i("div",re,[o(e(Y),{"model-value":s.filters.searchTerm,"onUpdate:modelValue":y,type:"text",placeholder:"Search customers (Name, Email, Stripe ID)",class:"input input-bordered w-full max-w-xs"},null,8,["model-value"]),o(e(P),null,{default:r(()=>[o(e(k),{"as-child":""},{default:r(()=>[o(e(U),{variant:"outline"},{default:r(()=>[t[0]||(t[0]=_(" Columns ",-1)),o(e(I),{class:"ml-2 h-4 w-4"})]),_:1,__:[0]})]),_:1}),o(e(S),{align:"end"},{default:r(()=>[(u(!0),f(g,null,C(s.columns,a=>(u(),b(e($),{key:a.column,class:"capitalize","model-value":a.active,"onUpdate:modelValue":c=>v(a.column,c)},{default:r(()=>[_(x(a.header),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1}),o(e(P),null,{default:r(()=>[o(e(k),{"as-child":""},{default:r(()=>[o(e(U),{variant:"outline"},{default:r(()=>[t[1]||(t[1]=_(" Currencies ",-1)),o(e(I),{class:"ml-2 h-4 w-4"})]),_:1,__:[1]})]),_:1}),o(e(S),{align:"end"},{default:r(()=>[(u(!0),f(g,null,C(s.filters.currencies,a=>(u(),b(e($),{key:a.currency,class:"capitalize","model-value":a.active,"onUpdate:modelValue":c=>n(a.currency,c)},{default:r(()=>[_(x(a.currency),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1}),i("div",ne,[o(e(q),{"model-value":s.filters.subscribedOnly,"onUpdate:modelValue":l,class:"ml-4"},null,8,["model-value"]),t[2]||(t[2]=i("label",null,"Subscribed only",-1))])])]))}}),ue={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto"},de={class:"flex items-center justify-between"},Pe=V({__name:"Index",setup(w){const m=[{title:"Customers",href:"/sales/customers"}],d=T({searchTerm:"",subscribedOnly:!1,currencies:[{currency:"usd",active:!0},{currency:"eur",active:!0}]}),p=T([{column:"name",header:"Name",active:!0,direction:"asc"},{column:"email",header:"Email",active:!0,direction:"asc"},{column:"cus_id",header:"Stripe ID",active:!0,direction:"asc"},{column:"subscribed",header:"Subscribed",active:!0,direction:"asc"},{column:"currency",header:"Currency",active:!0,direction:"asc"}]);return(y,l)=>(u(),f(g,null,[o(e(K),{title:"Customers"}),o(M,{breadcrumbs:m},{default:r(()=>[i("div",ue,[i("div",de,[l[5]||(l[5]=i("h1",{class:"text-2xl font-bold"},"Customers",-1)),o(e(P),null,{default:r(()=>[o(e(k),{"as-child":""},{default:r(()=>l[2]||(l[2]=[i("button",{class:"btn btn-primary"},"Actions",-1)])),_:1,__:[2]}),o(e(S),null,{default:r(()=>[o(e($),{checked:""},{default:r(()=>l[3]||(l[3]=[_("Export CSV",-1)])),_:1,__:[3]}),o(e($),null,{default:r(()=>l[4]||(l[4]=[_("Import CSV",-1)])),_:1,__:[4]})]),_:1})]),_:1})]),o(e(ie),{filters:d.value,"onUpdate:filters":l[0]||(l[0]=v=>d.value=v),columns:p.value,"onUpdate:columns":l[1]||(l[1]=v=>p.value=v)},null,8,["filters","columns"]),o(e(ae),{filters:d.value,columns:p.value},null,8,["filters","columns"])])]),_:1})],64))}});export{Pe as default};
