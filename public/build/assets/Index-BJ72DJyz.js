import{u as U,_ as N,a as L,b as O,c as z}from"./AppLayout.vue_vue_type_script_setup_true_lang-DRbdIml-.js";import{d as E,u as A,c as V,r as R,a as v,o as u,F as y,b as s,e as i,f as e,w as o,g as w,h as b,i as g,j as I,t as x,k as j,l as B,m as F,n as K}from"./app-C92-Y1dT.js";import{u as q,_ as H,a as J,b as X,c as S,d as T,e as G,g as Q,f as W}from"./index-D2kNPA_0.js";import{_ as D}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CAGyry6G.js";import{L as Y}from"./loader-circle-BbL23M-J.js";import{_ as Z}from"./Input.vue_vue_type_script_setup_true_lang-LCdgEt79.js";import{_ as ee}from"./Checkbox.vue_vue_type_script_setup_true_lang-77O0qTKt.js";import{_ as P}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-CiT8TZXJ.js";import{C as M}from"./chevron-down-VV9vBCGX.js";import{_ as te}from"./CreateContactDialog.vue_vue_type_script_setup_true_lang-Dd2wRjZN.js";import"./useForwardExpose-BtQXKgVi.js";import"./VisuallyHidden-BgXZxCVS.js";import"./check-CEckEDXI.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-BODExnsd.js";import"./Label.vue_vue_type_script_setup_true_lang-iJwOMYEc.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-Cuo0HhoR.js";const ae={class:"flex items-center justify-between space-x-2 py-4"},se={class:"flex items-center space-x-2"},oe=["value"],ne={class:"flex items-center space-x-2"},le={class:"text-sm text-gray-700"},ie={class:"flex space-x-1"},re=["disabled"],ue=["disabled"],de=["disabled"],ce=["disabled"],me=E({__name:"ContactTable",props:{filters:{},columns:{}},setup(k){const{toast:$}=U(),m=k,_=A(),h=V(()=>_.props.contacts||[]),C=V(()=>{let t=h.value||[];if(m.filters.searchTerm){const a=m.filters.searchTerm.toLowerCase();t=t.filter(p=>p.name?.toLowerCase().includes(a)||p?.organisation?.name?.toLowerCase().includes(a)||p?.email?.toLowerCase().includes(a)||p?.phone?.includes(a))}m.filters.danishOnly&&(t=t.filter(a=>a.country.toLowerCase()==="dk"));const n=m.filters.countries.filter(a=>a.active).map(a=>a.country);return n.length>0&&n.length<m.filters.countries.length&&(t=t.filter(a=>n.includes(a.country))),t}),r=V(()=>m.columns.filter(t=>t.active).map(t=>({accessorKey:t.column,header:t.header,cell:({row:n})=>n.getValue(t.column)}))),l=q({get data(){return C.value},get columns(){return r.value},getCoreRowModel:W(),getPaginationRowModel:Q(),initialState:{pagination:{pageSize:10}}}),d=R(null),f=t=>{F.visit(route("contacts.show",t.id))},c=t=>{d.value=t,fetch(`contacts/${t}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}).then(n=>{n.ok?($({title:"Organisation Deleted",description:"The organisation has been deleted successfully.",variant:"success"}),F.reload({only:["organisations"]})):($({title:"Failed to Delete Organisation",description:"The organisation could not be deleted.",variant:"destructive"}),console.error("Failed to delete organisation"))})};return(t,n)=>(u(),v(y,null,[s(e(H),null,{default:o(()=>[s(e(J),null,{default:o(()=>[(u(!0),v(y,null,w(e(l).getHeaderGroups(),a=>(u(),b(e(T),{key:a.id},{default:o(()=>[(u(!0),v(y,null,w(a.headers,p=>(u(),b(e(G),{key:p.id},{default:o(()=>[g(x(p.isPlaceholder?"":p.column.columnDef.header),1)]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),s(e(X),null,{default:o(()=>[e(l).getRowModel().rows.length?(u(!0),v(y,{key:0},w(e(l).getRowModel().rows,a=>(u(),b(e(T),{key:a.id,onClick:p=>f(a.original),class:"cursor-pointer hover:bg-gray-100"},{default:o(()=>[(u(!0),v(y,null,w(a.getVisibleCells(),p=>(u(),b(e(S),{key:p.id},{default:o(()=>[g(x(p.getValue()),1)]),_:2},1024))),128)),s(e(S),null,{default:o(()=>[s(e(D),{size:"sm",variant:"destructive",onClick:j(p=>c(a.original.id),["stop"]),disabled:d.value===a.original.id},{default:o(()=>[d.value===a.original.id?(u(),b(e(Y),{key:0,class:"h-4 w-4 animate-spin"})):B("",!0),n[5]||(n[5]=g(" Delete ",-1))]),_:2,__:[5]},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1032,["onClick"]))),128)):(u(),b(e(T),{key:1},{default:o(()=>[s(e(S),{colspan:r.value.length,class:"h-24 text-center"},{default:o(()=>n[6]||(n[6]=[g(" No organisations found. ",-1)])),_:1,__:[6]},8,["colspan"])]),_:1}))]),_:1})]),_:1}),i("div",ae,[i("div",se,[n[8]||(n[8]=i("span",{class:"text-sm text-gray-700"},"Rows per page:",-1)),i("select",{value:e(l).getState().pagination.pageSize,onChange:n[0]||(n[0]=a=>e(l).setPageSize(Number(a.target.value))),class:"border rounded px-2 py-1"},n[7]||(n[7]=[I('<option value="5">5</option><option value="10">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option>',5)]),40,oe)]),i("div",ne,[i("span",le," Page "+x(e(l).getState().pagination.pageIndex+1)+" of "+x(e(l).getPageCount())+" ("+x(e(l).getFilteredRowModel().rows.length)+" total rows) ",1),i("div",ie,[i("button",{onClick:n[1]||(n[1]=a=>e(l).setPageIndex(0)),disabled:!e(l).getCanPreviousPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," First ",8,re),i("button",{onClick:n[2]||(n[2]=a=>e(l).previousPage()),disabled:!e(l).getCanPreviousPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Previous ",8,ue),i("button",{onClick:n[3]||(n[3]=a=>e(l).nextPage()),disabled:!e(l).getCanNextPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Next ",8,de),i("button",{onClick:n[4]||(n[4]=a=>e(l).setPageIndex(e(l).getPageCount()-1)),disabled:!e(l).getCanNextPage(),class:"px-2 py-1 border rounded disabled:opacity-50"}," Last ",8,ce)])])])],64))}}),pe={class:"flex items-center gap-8"},fe={class:"flex items-center gap-4 w-full"},_e={class:"flex items-center gap-2"},ge=E({__name:"ContactFilters",props:{filters:{},columns:{}},emits:["update:filters","update:columns"],setup(k,{emit:$}){const m=k,_=$,h=d=>{_("update:filters",{...m.filters,searchTerm:d})},C=d=>{_("update:filters",{...m.filters,danishOnly:d})},r=(d,f)=>{const c=m.columns.map(t=>t.column===d?{...t,active:f}:t);_("update:columns",c)},l=(d,f)=>{const c=m.filters.countries.map(t=>t.country===d?{...t,active:f}:t);_("update:filters",{...m.filters,countries:c})};return(d,f)=>(u(),v("div",pe,[i("div",fe,[s(e(Z),{"model-value":d.filters.searchTerm,"onUpdate:modelValue":h,type:"text",placeholder:"Search Contacts (Name, Email, Phone, Organisation)",class:"input input-bordered w-full max-w-xs"},null,8,["model-value"]),s(e(N),null,{default:o(()=>[s(e(L),{"as-child":""},{default:o(()=>[s(e(D),{variant:"outline"},{default:o(()=>[f[0]||(f[0]=g(" Columns ",-1)),s(e(M),{class:"ml-2 h-4 w-4"})]),_:1,__:[0]})]),_:1}),s(e(O),{align:"end"},{default:o(()=>[(u(!0),v(y,null,w(d.columns,c=>(u(),b(e(P),{key:c.column,class:"capitalize","model-value":c.active,"onUpdate:modelValue":t=>r(c.column,t)},{default:o(()=>[g(x(c.header),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1}),s(e(N),null,{default:o(()=>[s(e(L),{"as-child":""},{default:o(()=>[s(e(D),{variant:"outline"},{default:o(()=>[f[1]||(f[1]=g(" Countries ",-1)),s(e(M),{class:"ml-2 h-4 w-4"})]),_:1,__:[1]})]),_:1}),s(e(O),{align:"end"},{default:o(()=>[(u(!0),v(y,null,w(d.filters.countries,c=>(u(),b(e(P),{key:c.country,class:"capitalize","model-value":c.active,"onUpdate:modelValue":t=>l(c.country,t)},{default:o(()=>[g(x(c.country),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1}),i("div",_e,[s(e(ee),{"model-value":d.filters.danishOnly,"onUpdate:modelValue":C,class:"ml-4"},null,8,["model-value"]),f[2]||(f[2]=i("label",null,"Danish only",-1))])])]))}}),ve={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto"},Ce={class:"flex items-center justify-between"},be={class:"flex gap-4"},Fe=E({__name:"Index",props:["contacts"],setup(k){const $=[{title:"Contacts",href:"/contacts"}],m=k,_=R({searchTerm:"",danishOnly:!1,countries:[...Array.from(new Set(m.contacts.map(C=>C.country))).map(C=>({country:C,active:!0}))]}),h=R([{column:"name",header:"Name",active:!0,direction:"asc"},{column:"organisation.name",header:"Organisation",active:!0,direction:"asc"},{column:"country",header:"Country",active:!0,direction:"asc"},{column:"email",header:"Email",active:!0,direction:"asc"},{column:"phone",header:"Phone",active:!0,direction:"asc"},{column:"job",header:"Job",active:!0,direction:"asc"}]);return(C,r)=>(u(),v(y,null,[s(e(K),{title:"Contacts"}),s(z,{breadcrumbs:$},{default:o(()=>[i("div",ve,[i("div",Ce,[r[5]||(r[5]=i("h1",{class:"text-2xl font-bold"},"Contacts",-1)),i("div",be,[s(e(te)),s(e(N),null,{default:o(()=>[s(e(L),{"as-child":""},{default:o(()=>r[2]||(r[2]=[i("button",{class:"btn btn-primary"},"Actions",-1)])),_:1,__:[2]}),s(e(O),null,{default:o(()=>[s(e(P),{checked:""},{default:o(()=>r[3]||(r[3]=[g("Export CSV",-1)])),_:1,__:[3]}),s(e(P),null,{default:o(()=>r[4]||(r[4]=[g("Import CSV",-1)])),_:1,__:[4]})]),_:1})]),_:1})])]),s(e(ge),{filters:_.value,"onUpdate:filters":r[0]||(r[0]=l=>_.value=l),columns:h.value,"onUpdate:columns":r[1]||(r[1]=l=>h.value=l)},null,8,["filters","columns"]),s(e(me),{filters:_.value,columns:h.value},null,8,["filters","columns"])])]),_:1})],64))}});export{Fe as default};
