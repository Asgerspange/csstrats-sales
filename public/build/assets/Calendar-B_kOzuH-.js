import{_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-B9VxEYPj.js";import{d as tt,u as et,c as p,r as at,a as i,o,b as m,e as u,h as st,w as c,f as a,g as y,t as d,F as b,i as _,j as I,l as nt,n as rt,k as ot}from"./app-dWRfawAS.js";import{_ as lt,a as dt,b as it,c as ut}from"./CardTitle.vue_vue_type_script_setup_true_lang-Cgkxb_Q7.js";import{_ as ct}from"./CardDescription.vue_vue_type_script_setup_true_lang-DsLNdfeb.js";import{_ as x}from"./index-Cjbhqsii.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CPfIn9pl.js";import"./useForwardExpose-CNTMZeSX.js";import"./VisuallyHidden-jyn4G8ao.js";const mt={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4 overflow-x-auto"},ft={class:"flex items-center justify-between"},gt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},pt={class:"flex items-center justify-between mb-2"},yt={class:"font-medium"},bt={class:"text-xs text-muted-foreground"},_t={class:"flex gap-1 text-xs text-emerald-700 dark:text-emerald-300 mb-1"},xt={class:"grid grid-cols-7 gap-1"},ht={key:0,class:"h-full"},vt=["title"],kt={key:0,class:"absolute -bottom-1 inset-x-0 flex justify-center"},$t={class:"space-y-3"},wt={class:"overflow-hidden rounded-xl border border-border"},Dt={class:"min-w-full text-sm"},St={class:"px-4 py-3"},Pt={class:"px-4 py-3 text-muted-foreground"},Ct={class:"px-4 py-3 font-semibold"},Mt={class:"px-4 py-3"},Ft={key:1,class:"text-muted-foreground"},Tt={class:"px-4 py-3"},Yt={class:"px-4 py-3"},jt={class:"flex justify-between items-center mt-2 text-sm"},Bt=["disabled"],Nt=["disabled"],F=15,Ot=tt({__name:"Calendar",setup(It){const{props:A}=et(),T=A.upcomingPayments,L=[{title:"Billing",href:"/billing/calendar"}],h=e=>new Date(e),v=new Date,k=p(()=>{if(!T)return[];const e=new Date,t=e.getMonth()>=4?e.getFullYear():e.getFullYear()-1,s=new Date(t,4,1),n=new Date(t+1,3,30);return T.filter(r=>{const l=h(r.date);return l>=s&&l<=n})}),V=p(()=>{const e={};for(const t of k.value??[]){const s=$(t.date);e[s]||(e[s]=[]),e[s].push(t)}return e}),U=p(()=>z(v));function z(e){const t=[],s=e.getMonth()>=4?e.getFullYear():e.getFullYear()-1;for(let n=0;n<12;n++){const r=s+Math.floor((4+n)/12),l=(4+n)%12,N=new Date(r,l,1),K=N.toLocaleString("en-US",{month:"long"}),Q=E(N),R=new Date(r,l+1,0).getDate(),S=[];for(let g=0;g<Q;g++)S.push({key:`b-${r}-${l}-b${g}`,blank:!0});for(let g=1;g<=R;g++){const P=new Date(r,l,g),C=$(P),M=V.value[C]??[],X=q(P,v);S.push({key:C,blank:!1,day:g,date:P,payments:M,isToday:X,title:M.length?`${M.length} payments`:w(C)})}t.push({key:`${r}-${l}`,label:K,year:r,month:l,cells:S})}return t}function E(e){return(e.getDay()+6)%7}function q(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function $(e){const t=new Date(e);t.setHours(0,0,0,0);const s=t.getFullYear(),n=`${t.getMonth()+1}`.padStart(2,"0"),r=`${t.getDate()}`.padStart(2,"0");return`${s}-${n}-${r}`}function w(e){return(typeof e=="string"?new Date(e):e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function Y(e,t){return new Intl.NumberFormat(void 0,{style:"currency",currency:t}).format(e/100)}const H=p(()=>w(v));function O(e){const t="border rounded-lg transition-colors flex items-center justify-center text-sm relative",s=e.payments.length>0,n=e.payments.some(l=>l.interval==="year"),r=e.payments.some(l=>l.interval==="semi-annually");return n&&r&&e.isToday?`${t} bg-gradient-to-r from-purple-600/40 via-blue-600/40 to-emerald-800/50 border-emerald-600 text-white dark:text-emerald-200`:n&&r?`${t} bg-[linear-gradient(to_right,rgba(239,68,68,0.2)_0%,rgba(239,68,68,0.2)_50%,rgba(30,64,175,0.3)_50%,rgba(30,64,175,0.3)_100%)] border-emerald-600 text-emerald-900 dark:text-emerald-200`:n&&e.isToday?`${t} bg-purple-600/40 border-emerald-600 text-white dark:text-emerald-200`:n?`${t} bg-red-600/20 border-emerald-600 text-emerald-900 dark:text-emerald-200`:r&&e.isToday?`${t} bg-blue-600/40 border-blue-600 text-white dark:text-blue-200`:r?`${t} bg-blue-500/20 border-blue-500 text-blue-900 dark:text-blue-200`:s&&e.isToday?`${t} bg-emerald-800/50 border-emerald-500 text-emerald-900 dark:text-emerald-200`:s?`${t} bg-emerald-500/20 border-emerald-500 text-emerald-900 dark:text-emerald-200`:e.isToday?`${t} bg-neutral-200 dark:bg-neutral-700 border-neutral-400 dark:border-neutral-600`:`${t} bg-neutral-100 dark:bg-neutral-800 border-neutral-300 dark:border-neutral-700 text-neutral-600 dark:text-neutral-300`}const f=at(1),j=p(()=>[...k.value].sort((e,t)=>h(e.date).getTime()-h(t.date).getTime())),D=p(()=>Math.ceil(j.value.length/F)),W=p(()=>{const e=(f.value-1)*F;return j.value.slice(e,e+F)});function G(){f.value<D.value&&f.value++}function J(){f.value>1&&f.value--}const B=p(()=>{const e={};for(const t of k.value){if(t.status!=="paid"&&t.status!=="upcoming")continue;const s=new Date(t.date),n=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;e[n]||(e[n]={});const r=t.currency||"USD";e[n][r]=(e[n][r]||0)+t.amount}return e});return console.log(B.value),(e,t)=>(o(),i(b,null,[m(u(st),{title:"Billing Calendar"}),m(Z,{breadcrumbs:L},{default:c(()=>[a("div",mt,[m(u(lt),null,{default:c(()=>[m(u(dt),null,{default:c(()=>[a("div",ft,[m(u(it),{class:"text-xl font-semibold"},{default:c(()=>t[0]||(t[0]=[y("Subscription Payment Calendar",-1)])),_:1,__:[0]}),m(u(x),{variant:"secondary"},{default:c(()=>[y("Today: "+d(H.value),1)]),_:1})]),m(u(ct),null,{default:c(()=>t[1]||(t[1]=[y("All previous and upcoming Stripe payments from the accounting period May to April",-1)])),_:1,__:[1]})]),_:1}),m(u(ut),{class:"space-y-8"},{default:c(()=>[a("div",gt,[(o(!0),i(b,null,_(U.value,s=>(o(),i("div",{key:s.key,class:"rounded-xl border border-border bg-card p-3"},[a("div",pt,[a("div",yt,d(s.label),1),a("div",bt,d(s.year),1)]),a("div",_t,[(o(!0),i(b,null,_(B.value[`${s.year}-${String(s.month+1).padStart(2,"0")}`],(n,r)=>(o(),i("span",{key:r},d(Y(n,r)),1))),128))]),t[3]||(t[3]=a("div",{class:"grid grid-cols-7 text-xs text-muted-foreground mb-1"},[a("div",{class:"text-center"},"Mon"),a("div",{class:"text-center"},"Tue"),a("div",{class:"text-center"},"Wed"),a("div",{class:"text-center"},"Thu"),a("div",{class:"text-center"},"Fri"),a("div",{class:"text-center"},"Sat"),a("div",{class:"text-center"},"Sun")],-1)),a("div",xt,[(o(!0),i(b,null,_(s.cells,n=>(o(),i("div",{key:n.key,class:"aspect-square"},[n.blank?(o(),i("div",ht)):(o(),I(u(nt),{key:1,href:`/billing/date/${$(n.date)}`,class:"block h-full"},{default:c(()=>[a("div",{class:rt(O(n)),title:n.title},[a("span",null,d(n.day),1),n.payments.length?(o(),i("div",kt,t[2]||(t[2]=[a("span",{class:"h-1.5 w-1.5 rounded-full bg-emerald-500"},null,-1)]))):ot("",!0)],10,vt)]),_:2},1032,["href"]))]))),128))])]))),128))]),a("div",$t,[t[5]||(t[5]=a("div",{class:"text-sm text-muted-foreground"},"Upcoming charges (all customers)",-1)),a("div",wt,[a("table",Dt,[t[4]||(t[4]=a("thead",{class:"bg-muted"},[a("tr",null,[a("th",{class:"px-4 py-3 text-left font-medium"},"Date"),a("th",{class:"px-4 py-3 text-left font-medium"},"Customer"),a("th",{class:"px-4 py-3 text-left font-medium"},"Amount"),a("th",{class:"px-4 py-3 text-left font-medium"},"Coupon"),a("th",{class:"px-4 py-3 text-left font-medium"},"Status"),a("th",{class:"px-4 py-3 text-left font-medium"},"Interval")])],-1)),a("tbody",null,[(o(!0),i(b,null,_(W.value,s=>(o(),i("tr",{key:s.date+s.customer_id,class:"border-t border-border"},[a("td",St,d(w(s.date)),1),a("td",Pt,d(s.customer_id),1),a("td",Ct,d(Y(s.amount,s.currency)),1),a("td",Mt,[s.coupon?(o(),I(u(x),{key:0,variant:"secondary"},{default:c(()=>[y(d(s.coupon),1)]),_:2},1024)):(o(),i("span",Ft,"â€”"))]),a("td",Tt,[m(u(x),{variant:s.status==="paid"?"outline":"default"},{default:c(()=>[y(d(s.status??"scheduled"),1)]),_:2},1032,["variant"])]),a("td",Yt,[m(u(x),{variant:s.interval==="month"?"outline":"default"},{default:c(()=>[y(d(s.interval),1)]),_:2},1032,["variant"])])]))),128))])])]),a("div",jt,[a("button",{onClick:J,disabled:f.value===1,class:"px-3 py-1 border rounded disabled:opacity-50"},"Previous",8,Bt),a("div",null,"Page "+d(f.value)+" of "+d(D.value),1),a("button",{onClick:G,disabled:f.value===D.value,class:"px-3 py-1 border rounded disabled:opacity-50"},"Next",8,Nt)])])]),_:1})]),_:1})])]),_:1})],64))}});export{Ot as default};
